

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Correcting unsatisfcatory segmentation results &mdash; AI Framework 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Miscellaneous" href="misc.html" />
    <link rel="prev" title="Polygonisation" href="polygonisation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> AI Framework
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Segmentation models:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing.html">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="polygonisation.html">Polygonisation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Correcting unsatisfcatory segmentation results</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#manually-annotating-ground-truth-data">Manually annotating ground truth data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-a-focal-loss-function">Using a focal loss function</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AI Framework</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Correcting unsatisfcatory segmentation results</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/corrections.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="correcting-unsatisfcatory-segmentation-results">
<h1>Correcting unsatisfcatory segmentation results<a class="headerlink" href="#correcting-unsatisfcatory-segmentation-results" title="Permalink to this headline">¶</a></h1>
<p>You may run into the situation where a segmentation model produces
poor results delineating certain difficult objects. There are currently
two methods to rectify this situation which can be done independently or
combined.</p>
<div class="section" id="manually-annotating-ground-truth-data">
<h2>Manually annotating ground truth data<a class="headerlink" href="#manually-annotating-ground-truth-data" title="Permalink to this headline">¶</a></h2>
<p>The first and simplest way is to provide an accurate ground-truth
segmentation mask for the poorly-segmented objects and retrain your
model with these included in the training data.</p>
<p>For example, suppose that you have observed serious errors in a test region
<cite>bad_AoI.tif</cite> for which you currently do not have ground truth data. You
can then manually draw the correct object boundaries in, for example,
a shapefile <cite>bad_AoI_ground_truth.shp</cite>. You can then create a new dataset as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gim_cv.datasets</span> <span class="k">as</span> <span class="nn">datasets</span>

<span class="n">corrected_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
    <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;bad_AoI&#39;</span><span class="p">,</span>
    <span class="n">spatial_resolution</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">image_paths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;/path/to/bad_AoI.tif&#39;</span><span class="p">],</span>
    <span class="n">mask_paths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;/path/to/bad_AoI_ground_truth.shp&#39;</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You can then follow the instructions to train a model including this additional
dataset described in <a class="reference internal" href="training.html"><span class="doc">Training</span></a>.</p>
</div>
<div class="section" id="using-a-focal-loss-function">
<h2>Using a focal loss function<a class="headerlink" href="#using-a-focal-loss-function" title="Permalink to this headline">¶</a></h2>
<p>The second method is to train your model with a “focal” loss function, i.e. a loss
function constructed to punish the model especially hard for more serious segmentation errors.
The outcome of this will likely be that the model learns to perform better on more
difficult objects, but may lose some of its discriminating ability on easier examples
since they have a smaller relative impact on the loss.</p>
<p>Most focal loss functions have a focal exponent which steepens the slope of the loss function
further away from zero (i.e. the worse the model performs on a given example). This can be
treated as a parameter to tune to find a good compromise.</p>
<p>Currently implemented focal loss functions in are:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">gim_cv.losses.focal_tversky_loss()</span></code></p></li>
</ul>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="misc.html" class="btn btn-neutral float-right" title="Miscellaneous" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="polygonisation.html" class="btn btn-neutral float-left" title="Polygonisation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Nlemba Laurent, Liam Moore.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>